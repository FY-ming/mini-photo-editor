# 开发日志


## 2025.11.20 - 项目启动日

### 今日成就
- 配置基础开发环境
- 调试环境搭建及问题解决

### 遇到的问题
#### 1. MuMu模拟器ADB连接问题
**问题**：`adb connect` 失败，提示"计算机积极拒绝"

**解决**：次日重启电脑，重启模拟器后恢复正常

**根本原因**：模拟器虚拟网络连接异常

**收获**：理解了ADB客户端-服务器架构，掌握了模拟器网络问题的标准排查流程、adb使用流程。



## 2025.11.21 -正式动工

### 今日成就
- 创建GitHub仓库并初始化项目结构
- README文件初始化
- 学习GitHub仓库规范、项目文件规范、README书写技巧
- 创建开发问题记录文档
- 初始化本地git仓库


## 2025.11.22 -跟进 项目正式开始code前的架构思考 

### 今日成就 
- 文件创建与架构设计 
- 软件核心功能的确定以及具体用户使用流程的梳理

### 项目架构设计思考
#### 最初的困惑
- 一开始我对项目架构很迷茫： 
- 应该先写代码还是先设计架构？ 
- 各个模块之间应该如何通信？ 
- 数据应该如何在界面间传递？

但考虑到之前的经验，如果使用不成熟的架构实现程序的雏形，后续在其上更改时可谓是难于登天。所以我打算在正式开工code前，先决定自己应该如何完成这个项目。

在思考与学习的过程中，我了解到了很多更加成熟的思想： **模块化分离的认知过程：**
- 最初：觉得所有代码放在一起也可以工作
- 问题：意识到后期维护会变得困难
- 解决方案：按功能划分包结构，即使当前有些包是空的

#### MVVM架构的理解：
- 为什么选择MVVM？因为它是Android官方推荐的现代架构
- 与MVP的区别：ViewModel自动处理生命周期，减少内存泄漏风险
- 实际应用：为每个界面创建对应的ViewModel，即使暂时没有数据逻辑

### 技术选型的实际考量
#### OpenGL ES的选择：
- 真实原因：项目要求中明确提到需要OpenGL ES渲染
- 学习成本：知道这是个挑战，但愿意尝试
- 备选方案：如果OpenGL太难，后期可以降级到Canvas实现基础功能
#### MediaStore的决策：
- 选择原因：这是访问系统相册的标准方式
- 担忧：知道有厂商兼容性问题需要处理
- 计划：先实现基础功能，再逐个解决适配问题

### 实际的文件架构创建
#### 关于技术债务的考虑
创建了很多暂时用不到的空类文件，这是有意为之：
- 为未来功能预留了明确的扩展点
- 避免了后期大规模重构的风险
- 虽然当前代码看起来"臃肿"，开发之初还未完全清晰各个模块的功能划分，主观上感觉非常混乱，但架构更清晰

创建了：

- data 模型和仓库类 → 为数据管理做准备
- editor/export 等界面文件 → 为后续界面开发做准备
- utils → 为工具函数做准备

这些文件现在看起来是"超前设计"，但目的是：
1. 建立清晰的项目结构
2. 避免后期大规模重构
3. 明确每个模块的职责边界

虽然现在起步阶段这么多空文件堆在一起很头疼，但是我觉得收益还是更大的，它们能更好帮助我在开发过程中不断思考现在的设计是否合理。

### app核心功能与用户使用流程梳理
#### 核心功能
为了不是盲目摸索产品的ui，我参考了包括醒图在内的若干修图软件的界面设计，最终整理了一份我的小型修
图app最基本的界面设计需求：
1. 作为修图软件，它应该实现最起码的修图功能。这边我的想法是它的界面和市面上的修图软件可以是类
似的： 整个app的下方应该有个按钮栏可以选择主页、其他拓展功能（软件社区之类）、我的（用户信
息），这几个界面来回切换
2. 然后，整个软件的基本功能我认为，最基础的：
   1. 能在主页打开相册
   2. 从相册页选取照片
   3. 能对照片修图
   4. 能导出修图后的图片

#### app设计结构：
**底部导航栏结构** [首页] - [其他功能（P图/社区）] - [我的/帮助]
**核心功能流程：** 首页 → 相册 → 选择照片 → P图界面 → 导出
**用户完整流程** 打开App → 首页点击[选择照片] → 相册选择图片 → 编辑器进行修图 → 点击保存 → 自动导出到相册 → 返回首页

整理完整个app的基本功能的执行流程，**最终我确认了自己第一版的最小任务集。**

#### 第一版本核心功能清单

**必须完成的功能：**
1. 首页 → 相册入口 + 最近编辑记录
2. 相册 → 图片选择
3. 编辑器 → 基础渲染 + 1个编辑功能（建议裁剪）
4. 导出 → 保存到相册


## 2025.11.23 - UI 界面设计

为了设计出更合理的系统架构，我决定先完成项目界面的初步设计，再跟进系统设计的细节。最终结合此前梳理的核心功能，稳步推进界面优化工作。

### 设计思路演进

#### UI 设计的思考过程

**问题 1：底部导航应该包含哪些页面？**

- 思考：
    - 仅放置 “首页” 会让界面显得单薄，缺乏产品完整性；
    - 放置过多功能则会大幅增加开发压力，不符合起步阶段的节奏；
    - 参考各类修图软件的设计逻辑，最终确定底部导航结构：首页（核心）+ 其他（扩展）+ 我的（用户信息）。
- 结论：既体现产品完整性，又为未来功能拓展预留空间。

**问题 2：首页应该包含什么内容？**

- 思考：
    - 仅保留 “选择照片” 按钮过于简单，缺乏基础交互性；
    - 加入过多编辑功能则偏离 “从相册选择照片” 的核心流程，导致起步阶段开发任务过于复杂；
    - 最终决定：首页突出 “选择照片” 主操作按钮 + 最近编辑记录模块。
- 结论：既保证界面简洁性，又完成首页最基础的设计落地，保留后续修改和拓展的灵活性。

### 遇到的问题及解决

**问题 1：资源链接失败**

- 现象：编译报错，提示找不到 dimen 资源（header\_height）；
- 原因分析：XML 布局中引用了`header_height`，但`dimens.xml`文件未定义该属性，属于 “想当然” 的疏漏；
- 解决：系统性检查所有资源引用，补全缺失的`dimen`定义；
- 教训：编写布局文件时需同步更新资源文件，避免只写引用不补定义的半拉子操作。

**问题 2：MainActivity 类找不到**

- 现象：App 闪退，抛出`ClassNotFoundException`；
- 根本原因：调整 MainActivity 文件路径后，`AndroidManifest.xml`中声明的 Activity 路径与实际包名不匹配（声明路径为`.MainActivity`，实际路径为`com.example.mini_photo_editor.ui.MainActivity`），包结构层次未在配置中体现；
- 解决：在`AndroidManifest.xml`中补充 MainActivity 的完整包路径；
- 收获：理解 Android 组件注册的包名解析规则，明确配置文件与实际代码路径一致性的重要性。

### 设计决策背后的思考

**为什么选择当前的首页布局？** 
最初想设计功能丰富的首页，但结合项目定位（小型修图软件 Demo）
**反思：**
产品核心价值是 “修图” 功能，而非 “首页展示”；用户打开 App 的核心诉求是处理照片，而开发的优先级也应聚焦核心功能落地。因此首页需尽可能简洁，快速引导用户进入 “选择照片→修图” 的核心流程。

### 界面设计的反思

当前首页虽具备基本功能框架，但视觉效果存在明显不足：

- 缺乏现代感和品牌识别度；
- 布局扁平化，无层次感和视觉美感；
- 主操作按钮（选择照片）不够突出。

#### 下一步改进方向：

1. 优化主页视觉体验，同步推进其他页面的设计；
2. 完成相册界面和编辑界面的核心布局设计；
3. 明确产品界面的主题风格（色彩、字体、控件样式等）。

## 2025.11.25 - 梳理开发路线，核心功能开发

### 梳理开发路线
在完成初步的产品雏形后，我陷入到新的设计难题中：我的项目接下来应该如何推进？

考虑到实现难度和我的项目的核心需求，最终确定路线：
**本地核心功能 → UI美化 → 网络功能**

优先证明产品功能可行性，再到用户观感体验优化，最后再考虑更长远的联网功能或者其他细节优化。

### 核心功能开发
#### 具体内容梳理
都说核心功能了，那就实现如果用户完全进行合法操作时可以完成修图导出操作，具体功能如下：
1. 打开应用，主页的相册（选择照片）按钮可以交互。
2. 点击这个按钮可以跳转进入相册页。
   1. 注意实现相册页的ui设计
   2. 完成最基本的布局设计和滑动、选取功能
3. 在相册页选择完照片后（暂时只实现选择一张的情况，保留以后批量处理的可能），跳转到编辑页开始修图
   1. 注意完成编辑页ui设计
   2. 拟定暂时的各个修图功能的组件布局设计
4. 实现至少一项修图功能
   1. 拟定后期可能需要实现的修图功能
5. 实现导出功能，图片可以本地永久化

#### 数据流动设计
首页 -(空)→ 相册页 -(Uri)→ 编辑页 -(Bitmap处理)→ 导出

**关键决策：使用 Uri 传递而非 Bitmap**
- 避免大图片内存传输
- 支持后续的大图处理
- 符合Android最佳实践

## 2025.11.28 - 界面优化与用户体验提升

### 重要改进

- 将相册页从普通Fragment改为**全屏DialogFragment**
- 解决了底部导航栏在相册页依然可操作的不合理体验
- 修复了返回按钮在白色背景下的可见性问题

### 技术实现

- 使用`DialogFragment` + 全屏样式实现模态对话框
- 相册页现在只能通过返回按钮或系统返回键退出
- 优化了图标对比度

### 用户体验提升

- 相册页现在以**覆盖层**形式显示，视觉焦点更集中
- 避免了用户误操作底部导航导致流程中断
- 符合现代App的模态交互设计规范

### 当前状态

- [x]  首页 → 相册页跳转正常  
- [x]  相册页模态体验完整  
- [x]  返回操作流畅  
- [x]  相册图片加载  
- [ ]  编辑器功能（后续开发）

### 插曲
由于 git 回滚操作，导致 DEVELOPMENT 内容意外丢失，开发记录需要重新提交和备份。在重新整理后，基本恢复开发记录，将DEVELOPMENT文件单独进行一次提交，防止再一次出现回滚导致的内容丢失。